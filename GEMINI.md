# Gemini Project Overview: mcp-neovim-server

This document provides a comprehensive overview of the `mcp-neovim-server` project, generated by Gemini based on its analysis of the source code.

## Project Overview

This is a Neovim MCP (Model Context Protocol) server that allows a client like Claude Desktop to interact with a running Neovim instance. It exposes Neovim's functionality as a set of tools and resources that an AI model can use.

### Core Functionality

- **Connection**: Connects to a Neovim instance via a socket file (e.g., `/tmp/nvim`).
- **Resources**: Exposes various aspects of the Neovim state as resources, including:
  - `nvim://session`: The current editor session.
  - `nvim://buffers`: The list of open buffers.
  - `nvim://project-structure`: The file tree of the current project.
  - `nvim://git-status`: The status of the current Git repository.
  - `nvim://lsp-diagnostics`: Diagnostics from the Language Server Protocol.
  - And many more.
- **Tools**: Provides a comprehensive set of tools for interacting with Neovim, such as:
  - `vim_buffer`: Read buffer contents.
  - `vim_command`: Execute Vim commands.
  - `vim_edit`: Edit buffer content.
  - `vim_status`: Get the current status of Neovim.
  - `vim_window`: Manage windows.
  - `vim_search`, `vim_grep`: Search and replace.
  - And many more advanced tools for managing macros, tabs, folds, etc.

## Project Structure

The project is a TypeScript application with the following structure:

- `src/index.ts`: The main entry point of the server. It initializes the MCP server, registers all the resources and tools, and handles the connection to the client.
- `src/neovim.ts`: This file contains the `NeovimManager` class, which is responsible for all interactions with the Neovim instance. It uses the `neovim` Node.js client library to communicate with Neovim. It also defines custom error classes for better error handling.
- `package.json`: Defines the project's metadata, dependencies, and scripts.
- `tsconfig.json`: The TypeScript compiler configuration.

## How it Works

1.  The server starts and creates an MCP server instance.
2.  It defines a set of resources and tools that correspond to Neovim's features.
3.  The `NeovimManager` class handles the low-level communication with Neovim. It connects to the Neovim socket and uses the `neovim` library to send commands and receive data.
4.  When the MCP server receives a request from a client (e.g., to get the content of a buffer), it calls the corresponding function in the `NeovimManager`.
5.  The `NeovimManager` interacts with Neovim to fulfill the request and returns the result to the MCP server, which then sends it back to the client.

## Key Technologies

- **TypeScript**: The language used to build the server.
- **Node.js**: The runtime environment.
- **@modelcontextprotocol/sdk**: The MCP SDK for creating the server.
- **neovim**: The Node.js client for Neovim.
- **Zod**: Used for schema validation of tool parameters.

## How to Run

1.  Install dependencies: `npm install`
2.  Build the project: `npm run build`
3.  Run the server: The binary is created at `build/index.js` and can be run via the `bin` entry in `package.json` (`mcp-neovim-server`).

### Configuration

The server can be configured using environment variables:

- `ALLOW_SHELL_COMMANDS`: Set to `true` to allow executing shell commands from Neovim.
- `NVIM_SOCKET_PATH`: The path to the Neovim socket file (defaults to `/tmp/nvim`).
